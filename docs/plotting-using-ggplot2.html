<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 2 Plotting using ggplot2 | Exploratory data analysis for cancer biologists</title>
  <meta name="description" content="This workshop the second workshop designed for the Cancer MSc Students in UCL Cancer Institute to gain some confidence on using R (statistical) programming language in their MSc projects." />
  <meta name="generator" content="bookdown 0.33 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 2 Plotting using ggplot2 | Exploratory data analysis for cancer biologists" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="This workshop the second workshop designed for the Cancer MSc Students in UCL Cancer Institute to gain some confidence on using R (statistical) programming language in their MSc projects." />
  <meta name="github-repo" content="AMMHasan/Exploratory_data_analysis_for_cancer_biologists" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 2 Plotting using ggplot2 | Exploratory data analysis for cancer biologists" />
  
  <meta name="twitter:description" content="This workshop the second workshop designed for the Cancer MSc Students in UCL Cancer Institute to gain some confidence on using R (statistical) programming language in their MSc projects." />
  

<meta name="author" content="A M Mahedi Hasan" />


<meta name="date" content="2023-03-06" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="data-manipulation-using-dplyr.html"/>
<link rel="next" href="metabric-data-analysis.html"/>
<script src="assets/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="assets/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="assets/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="assets/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="assets/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="assets/kePrint-0.0.1/kePrint.js"></script>
<link href="assets/lightable-0.0.1/lightable.css" rel="stylesheet" />


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Exploratory data analysis for cancer biologists</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="preface.html"><a href="preface.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="1" data-path="data-manipulation-using-dplyr.html"><a href="data-manipulation-using-dplyr.html"><i class="fa fa-check"></i><b>1</b> Data manipulation using <code>dplyr</code></a>
<ul>
<li class="chapter" data-level="1.1" data-path="data-manipulation-using-dplyr.html"><a href="data-manipulation-using-dplyr.html#install"><i class="fa fa-check"></i><b>1.1</b> Install</a></li>
<li class="chapter" data-level="1.2" data-path="data-manipulation-using-dplyr.html"><a href="data-manipulation-using-dplyr.html#load-dplyr"><i class="fa fa-check"></i><b>1.2</b> Load <code>dplyr</code></a></li>
<li class="chapter" data-level="1.3" data-path="data-manipulation-using-dplyr.html"><a href="data-manipulation-using-dplyr.html#pipe-operator"><i class="fa fa-check"></i><b>1.3</b> Pipe operator %&gt;%</a></li>
<li class="chapter" data-level="1.4" data-path="data-manipulation-using-dplyr.html"><a href="data-manipulation-using-dplyr.html#dplyr-verbs"><i class="fa fa-check"></i><b>1.4</b> dplyr verbs</a>
<ul>
<li class="chapter" data-level="1.4.1" data-path="data-manipulation-using-dplyr.html"><a href="data-manipulation-using-dplyr.html#select"><i class="fa fa-check"></i><b>1.4.1</b> select()</a></li>
<li class="chapter" data-level="1.4.2" data-path="data-manipulation-using-dplyr.html"><a href="data-manipulation-using-dplyr.html#filter"><i class="fa fa-check"></i><b>1.4.2</b> filter()</a></li>
<li class="chapter" data-level="1.4.3" data-path="data-manipulation-using-dplyr.html"><a href="data-manipulation-using-dplyr.html#mutate"><i class="fa fa-check"></i><b>1.4.3</b> mutate()</a></li>
<li class="chapter" data-level="1.4.4" data-path="data-manipulation-using-dplyr.html"><a href="data-manipulation-using-dplyr.html#rename"><i class="fa fa-check"></i><b>1.4.4</b> rename()</a></li>
<li class="chapter" data-level="1.4.5" data-path="data-manipulation-using-dplyr.html"><a href="data-manipulation-using-dplyr.html#arrange"><i class="fa fa-check"></i><b>1.4.5</b> arrange()</a></li>
<li class="chapter" data-level="1.4.6" data-path="data-manipulation-using-dplyr.html"><a href="data-manipulation-using-dplyr.html#distinct"><i class="fa fa-check"></i><b>1.4.6</b> distinct()</a></li>
<li class="chapter" data-level="1.4.7" data-path="data-manipulation-using-dplyr.html"><a href="data-manipulation-using-dplyr.html#slice"><i class="fa fa-check"></i><b>1.4.7</b> slice()</a></li>
<li class="chapter" data-level="1.4.8" data-path="data-manipulation-using-dplyr.html"><a href="data-manipulation-using-dplyr.html#join"><i class="fa fa-check"></i><b>1.4.8</b> join</a></li>
<li class="chapter" data-level="1.4.9" data-path="data-manipulation-using-dplyr.html"><a href="data-manipulation-using-dplyr.html#group_by-and-summarise"><i class="fa fa-check"></i><b>1.4.9</b> group_by() and summarise()</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="plotting-using-ggplot2.html"><a href="plotting-using-ggplot2.html"><i class="fa fa-check"></i><b>2</b> Plotting using <code>ggplot2</code></a>
<ul>
<li class="chapter" data-level="2.1" data-path="plotting-using-ggplot2.html"><a href="plotting-using-ggplot2.html#mini-intro-to-ggplot2"><i class="fa fa-check"></i><b>2.1</b> Mini intro to <code>ggplot2</code></a></li>
<li class="chapter" data-level="2.2" data-path="plotting-using-ggplot2.html"><a href="plotting-using-ggplot2.html#installation"><i class="fa fa-check"></i><b>2.2</b> Installation</a></li>
<li class="chapter" data-level="2.3" data-path="plotting-using-ggplot2.html"><a href="plotting-using-ggplot2.html#plotting-with-ggplot2"><i class="fa fa-check"></i><b>2.3</b> Plotting with ggplot2</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="plotting-using-ggplot2.html"><a href="plotting-using-ggplot2.html#difference-between-base-r-plot-and-ggplot2"><i class="fa fa-check"></i><b>2.3.1</b> Difference between base <em>R</em> plot and ggplot2</a></li>
<li class="chapter" data-level="2.3.2" data-path="plotting-using-ggplot2.html"><a href="plotting-using-ggplot2.html#general-parameters-for-ggplot"><i class="fa fa-check"></i><b>2.3.2</b> General parameters for ggplot()</a></li>
<li class="chapter" data-level="2.3.3" data-path="plotting-using-ggplot2.html"><a href="plotting-using-ggplot2.html#the-rest-of-the-exercise-is-a-copy-of-the-top-50-ggplot2-visualizations---the-master-list-with-full-r-code."><i class="fa fa-check"></i><b>2.3.3</b> The rest of the exercise is a copy of the “Top 50 ggplot2 Visualizations - The Master List (With Full R Code)”.</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="metabric-data-analysis.html"><a href="metabric-data-analysis.html"><i class="fa fa-check"></i><b>3</b> Metabric data analysis</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Exploratory data analysis for cancer biologists</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="plotting-using-ggplot2" class="section level1 hasAnchor" number="2">
<h1><span class="header-section-number">Chapter 2</span> Plotting using <code>ggplot2</code><a href="plotting-using-ggplot2.html#plotting-using-ggplot2" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="mini-intro-to-ggplot2" class="section level2 hasAnchor" number="2.1">
<h2><span class="header-section-number">2.1</span> Mini intro to <code>ggplot2</code><a href="plotting-using-ggplot2.html#mini-intro-to-ggplot2" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>To my opinion, the most elegant package for data visualisation in <em>R</em> is <code>ggplot2</code>. Here, <em>gg</em> stands for the <em>grammar of graphics</em>. Put aside what you have learnt so far on basic <em>R</em> plotting techniques, <code>ggplot2</code> defines the art of plotting in a whole new way. The learning curve may be steep, but once you learn it, you will fall in love with it (I promise). You provide the data, tell <code>ggplot2</code> which variables to map to the aesthetics, and tell what do you want. <code>ggplot2</code> will take care of the rest.</p>
</div>
<div id="installation" class="section level2 hasAnchor" number="2.2">
<h2><span class="header-section-number">2.2</span> Installation<a href="plotting-using-ggplot2.html#installation" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The easiest way to get <code>ggplot2</code> is to install the whole <code>tidyverse</code>:</p>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="plotting-using-ggplot2.html#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="co">#install.packages(&quot;tidyverse&quot;)</span></span></code></pre></div>
<p>Alternatively, install just <code>ggplot2</code>:</p>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="plotting-using-ggplot2.html#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="co">#install.packages(&quot;ggplot2&quot;)</span></span></code></pre></div>
<p>Or the the development version from GitHub:</p>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="plotting-using-ggplot2.html#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="co">#install.packages(&quot;devtools&quot;)</span></span>
<span id="cb58-2"><a href="plotting-using-ggplot2.html#cb58-2" aria-hidden="true" tabindex="-1"></a><span class="co">#devtools::install_github(&quot;tidyverse/ggplot2&quot;)</span></span></code></pre></div>
<p>And then, load it …</p>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="plotting-using-ggplot2.html#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span></code></pre></div>
</div>
<div id="plotting-with-ggplot2" class="section level2 hasAnchor" number="2.3">
<h2><span class="header-section-number">2.3</span> Plotting with ggplot2<a href="plotting-using-ggplot2.html#plotting-with-ggplot2" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="difference-between-base-r-plot-and-ggplot2" class="section level3 hasAnchor" number="2.3.1">
<h3><span class="header-section-number">2.3.1</span> Difference between base <em>R</em> plot and ggplot2<a href="plotting-using-ggplot2.html#difference-between-base-r-plot-and-ggplot2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In this chapter, I will bwe using the <code>mtcars</code> dataset for plotting different graphs. For refreshing your memory, let’s have a look at the dataset -</p>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="plotting-using-ggplot2.html#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(mtcars)</span></code></pre></div>
<pre><code>##                    mpg cyl disp  hp drat    wt  qsec vs am gear carb
## Mazda RX4         21.0   6  160 110 3.90 2.620 16.46  0  1    4    4
## Mazda RX4 Wag     21.0   6  160 110 3.90 2.875 17.02  0  1    4    4
## Datsun 710        22.8   4  108  93 3.85 2.320 18.61  1  1    4    1
## Hornet 4 Drive    21.4   6  258 110 3.08 3.215 19.44  1  0    3    1
## Hornet Sportabout 18.7   8  360 175 3.15 3.440 17.02  0  0    3    2
## Valiant           18.1   6  225 105 2.76 3.460 20.22  1  0    3    1</code></pre>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="plotting-using-ggplot2.html#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(mtcars)</span></code></pre></div>
<pre><code>## &#39;data.frame&#39;:    32 obs. of  11 variables:
##  $ mpg : num  21 21 22.8 21.4 18.7 18.1 14.3 24.4 22.8 19.2 ...
##  $ cyl : num  6 6 4 6 8 6 8 4 4 6 ...
##  $ disp: num  160 160 108 258 360 ...
##  $ hp  : num  110 110 93 110 175 105 245 62 95 123 ...
##  $ drat: num  3.9 3.9 3.85 3.08 3.15 2.76 3.21 3.69 3.92 3.92 ...
##  $ wt  : num  2.62 2.88 2.32 3.21 3.44 ...
##  $ qsec: num  16.5 17 18.6 19.4 17 ...
##  $ vs  : num  0 0 1 1 0 1 0 1 1 1 ...
##  $ am  : num  1 1 1 0 0 0 0 0 0 0 ...
##  $ gear: num  4 4 4 3 3 3 3 4 4 4 ...
##  $ carb: num  4 4 1 1 2 1 4 2 2 4 ...</code></pre>
<p>Now, I will draw scatter plot using the base <em>R</em> <code>plot()</code> function, and then using <code>ggplot2</code>, I will show you the difference -</p>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="plotting-using-ggplot2.html#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="at">x=</span>mtcars<span class="sc">$</span>mpg, <span class="at">y=</span>mtcars<span class="sc">$</span>wt)</span></code></pre></div>
<p><img src="Exploratory_data_analysis_for_cancer_biologists_files/figure-html/base_R_vs_ggplot2_2-1.png" width="672" /></p>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="plotting-using-ggplot2.html#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mtcars, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x=</span>mpg,<span class="at">y=</span>wt)) <span class="sc">+</span> <span class="fu">geom_point</span>()</span></code></pre></div>
<p><img src="Exploratory_data_analysis_for_cancer_biologists_files/figure-html/base_R_vs_ggplot2_2-2.png" width="672" />
You can see the stark difference between them -</p>
</div>
<div id="general-parameters-for-ggplot" class="section level3 hasAnchor" number="2.3.2">
<h3><span class="header-section-number">2.3.2</span> General parameters for ggplot()<a href="plotting-using-ggplot2.html#general-parameters-for-ggplot" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>For plotting with <code>ggplot2</code>, you start with <code>ggplot()</code> function and you privide the data. You then put the parameters you need to plot, like - the aesthetic mapping using <code>mapping = aes()</code>. Then, you add on layers (like <code>geom_point()</code>), scale (like <code>scale_x_continuous()</code>), faceting specifications (like <code>facet_wrap()</code>), coordinate systems (like <code>coord_flip()</code>)</p>
<p>In short, these are the elements that you might see in a block of graph using <code>ggplot()</code> function -</p>
<ul>
<li><p>data</p></li>
<li><p>aesthetic mapping</p></li>
<li><p>geometric objects</p></li>
<li><p>statistical transformations</p></li>
<li><p>scales</p></li>
<li><p>coordinate systems</p></li>
<li><p>position adjustments</p></li>
<li><p>faceting</p></li>
</ul>
<p>You can specify different layers of the plot and combine using “+” operator. Now I will dive into different aspects of the <code>ggplot()</code> function -</p>
<div id="aesthetic-mapping-using-aes" class="section level4 hasAnchor" number="2.3.2.1">
<h4><span class="header-section-number">2.3.2.1</span> Aesthetic mapping using <code>aes()</code><a href="plotting-using-ggplot2.html#aesthetic-mapping-using-aes" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Here <em>aesthetic</em> means something that you can see. It is mainly the mapping between a visual attribute and a variable. These are some important aesthetics -</p>
<ul>
<li><p>position (x,y)</p></li>
<li><p>colour (basically the colour of the outer rim of the object)</p></li>
<li><p>fill (the filling-colour/inside-colour of the object)</p></li>
<li><p>shape (mainly of point)</p></li>
<li><p>line type</p></li>
<li><p>size etc</p></li>
</ul>
<p>You can read all about them on your Rstudio help panel by typing -</p>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="plotting-using-ggplot2.html#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="fu">help.search</span>(<span class="st">&quot;geom_&quot;</span>, <span class="at">package =</span> <span class="st">&quot;ggplot2&quot;</span>)</span></code></pre></div>
</div>
<div id="geomatric-objects-geom_" class="section level4 hasAnchor" number="2.3.2.2">
<h4><span class="header-section-number">2.3.2.2</span> Geomatric Objects `<code>geom_</code><a href="plotting-using-ggplot2.html#geomatric-objects-geom_" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>There are so many <code>geomes</code> in <code>ggplot2</code>, like -</p>
<ul>
<li><p><code>geom_point()</code></p></li>
<li><p><code>geom_lines()</code></p></li>
<li><p><code>geom_boxplot()</code></p></li>
</ul>
<p>Again, you can find the <code>geoms</code> by typing in -</p>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="plotting-using-ggplot2.html#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="fu">help.search</span>(<span class="st">&quot;geom_&quot;</span>, <span class="at">package =</span> <span class="st">&quot;ggplot2&quot;</span>)</span></code></pre></div>
<p>Now time to check what I have just mentioned, but before that (as usual) let’s check the data that we are going to use. I will switch to another dataset, called <code>mpg</code>, from <strong>R</strong>.</p>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="plotting-using-ggplot2.html#cb68-1" aria-hidden="true" tabindex="-1"></a>?mpg</span></code></pre></div>
<div id="scatter-plot-with-geom_point" class="section level5 hasAnchor" number="2.3.2.2.1">
<h5><span class="header-section-number">2.3.2.2.1</span> scatter plot with geom_point()<a href="plotting-using-ggplot2.html#scatter-plot-with-geom_point" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>I will now draw a scatter plot using <em>highway miles per gallon</em> as a function of <em>engine displacement (in litres)</em> -</p>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="plotting-using-ggplot2.html#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>mpg, <span class="fu">aes</span>(<span class="at">x=</span>displ, <span class="at">y=</span>hwy)) <span class="sc">+</span> <span class="fu">geom_point</span>()</span></code></pre></div>
<p><img src="Exploratory_data_analysis_for_cancer_biologists_files/figure-html/geom_point1-1.png" width="672" /></p>
<p>Interestingly, you can save the whole or part of the code snippet in a variable -</p>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="plotting-using-ggplot2.html#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="co"># can be saved in a vector first, then print it. Like -</span></span>
<span id="cb70-2"><a href="plotting-using-ggplot2.html#cb70-2" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>mpg, <span class="fu">aes</span>(<span class="at">x=</span>displ, <span class="at">y=</span>hwy)) <span class="sc">+</span> <span class="fu">geom_point</span>()</span>
<span id="cb70-3"><a href="plotting-using-ggplot2.html#cb70-3" aria-hidden="true" tabindex="-1"></a>p1</span></code></pre></div>
<p><img src="Exploratory_data_analysis_for_cancer_biologists_files/figure-html/geom_point2-1.png" width="672" /></p>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="plotting-using-ggplot2.html#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="co"># or </span></span>
<span id="cb71-2"><a href="plotting-using-ggplot2.html#cb71-2" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>mpg, <span class="fu">aes</span>(<span class="at">x=</span>displ, <span class="at">y=</span>hwy)) <span class="co"># saved as a base plot variable. I will call p and add different layer on it.</span></span>
<span id="cb71-3"><a href="plotting-using-ggplot2.html#cb71-3" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> p <span class="sc">+</span> <span class="fu">geom_point</span>() </span>
<span id="cb71-4"><a href="plotting-using-ggplot2.html#cb71-4" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> p <span class="sc">+</span> <span class="fu">geom_line</span>()</span>
<span id="cb71-5"><a href="plotting-using-ggplot2.html#cb71-5" aria-hidden="true" tabindex="-1"></a>p4 <span class="ot">&lt;-</span> p <span class="sc">+</span> <span class="fu">geom_smooth</span>()</span>
<span id="cb71-6"><a href="plotting-using-ggplot2.html#cb71-6" aria-hidden="true" tabindex="-1"></a>p5 <span class="ot">&lt;-</span> p2 <span class="sc">+</span> <span class="fu">geom_smooth</span>(<span class="at">se =</span> F, <span class="at">linetype=</span><span class="st">&quot;dashed&quot;</span>)</span>
<span id="cb71-7"><a href="plotting-using-ggplot2.html#cb71-7" aria-hidden="true" tabindex="-1"></a>p5</span></code></pre></div>
<pre><code>## `geom_smooth()` using method = &#39;loess&#39; and formula = &#39;y ~ x&#39;</code></pre>
<p><img src="Exploratory_data_analysis_for_cancer_biologists_files/figure-html/geom_point2-2.png" width="672" /></p>
<p>Now let’s play with colour and size -</p>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="plotting-using-ggplot2.html#cb73-1" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="at">colour=</span><span class="st">&quot;red&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.2</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="co"># outside aes(), affects the same for all</span></span></code></pre></div>
<p><img src="Exploratory_data_analysis_for_cancer_biologists_files/figure-html/geom_point3-1.png" width="672" /></p>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="plotting-using-ggplot2.html#cb74-1" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">colour=</span>year, <span class="at">shape=</span><span class="fu">factor</span>(cyl)), <span class="at">size =</span> <span class="dv">3</span>) <span class="co"># inside aes(), affects accordingly</span></span></code></pre></div>
<p><img src="Exploratory_data_analysis_for_cancer_biologists_files/figure-html/geom_point3-2.png" width="672" /></p>
<p>You can play with title and axis labels -</p>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="plotting-using-ggplot2.html#cb75-1" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> </span>
<span id="cb75-2"><a href="plotting-using-ggplot2.html#cb75-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">colour=</span>year), <span class="at">size =</span> <span class="dv">3</span>, <span class="at">alpha =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb75-3"><a href="plotting-using-ggplot2.html#cb75-3" aria-hidden="true" tabindex="-1"></a>  <span class="co">#geom_text(aes(label=model)) + # may be not a good idea now.</span></span>
<span id="cb75-4"><a href="plotting-using-ggplot2.html#cb75-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb75-5"><a href="plotting-using-ggplot2.html#cb75-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;Fuel efficiency vs Engine displacement&quot;</span>,</span>
<span id="cb75-6"><a href="plotting-using-ggplot2.html#cb75-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">&quot;Fuel efficiency decreases with the engine size&quot;</span>,</span>
<span id="cb75-7"><a href="plotting-using-ggplot2.html#cb75-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">caption =</span> <span class="st">&quot;Two-seater is an exception&quot;</span>,</span>
<span id="cb75-8"><a href="plotting-using-ggplot2.html#cb75-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;Engine displacement (L)&quot;</span>,</span>
<span id="cb75-9"><a href="plotting-using-ggplot2.html#cb75-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;Highway fule economy (mpg)&quot;</span>,</span>
<span id="cb75-10"><a href="plotting-using-ggplot2.html#cb75-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">colour =</span> <span class="st">&quot;Manufactrure year&quot;</span></span>
<span id="cb75-11"><a href="plotting-using-ggplot2.html#cb75-11" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
<p><img src="Exploratory_data_analysis_for_cancer_biologists_files/figure-html/geom_point4-1.png" width="672" /></p>
<p>If your datapoints are a bit tightly spaced, you can jitter a bit -</p>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="plotting-using-ggplot2.html#cb76-1" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> </span>
<span id="cb76-2"><a href="plotting-using-ggplot2.html#cb76-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">colour=</span>class), <span class="at">size =</span> <span class="dv">3</span>, <span class="at">position =</span> <span class="st">&quot;jitter&quot;</span>) <span class="co"># introducing jitter here. For controlling the amount of movements, you can use geom_jitter()</span></span></code></pre></div>
<p><img src="Exploratory_data_analysis_for_cancer_biologists_files/figure-html/geom_poin5-1.png" width="672" /></p>
<p>Let’s play with some scaling -</p>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="plotting-using-ggplot2.html#cb77-1" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> </span>
<span id="cb77-2"><a href="plotting-using-ggplot2.html#cb77-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">colour=</span>class), <span class="at">size =</span> <span class="dv">3</span>, <span class="at">alpha =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb77-3"><a href="plotting-using-ggplot2.html#cb77-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">name =</span> <span class="st">&quot;x-axis label changed&quot;</span>, <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">10</span>,<span class="at">by=</span><span class="dv">5</span>),<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">10</span>)) <span class="sc">+</span></span>
<span id="cb77-4"><a href="plotting-using-ggplot2.html#cb77-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">trans =</span> <span class="st">&quot;reverse&quot;</span>)</span></code></pre></div>
<p><img src="Exploratory_data_analysis_for_cancer_biologists_files/figure-html/geom_point6-1.png" width="672" /></p>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="plotting-using-ggplot2.html#cb78-1" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> </span>
<span id="cb78-2"><a href="plotting-using-ggplot2.html#cb78-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">colour=</span>class), <span class="at">size =</span> <span class="dv">3</span>, <span class="at">alpha =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb78-3"><a href="plotting-using-ggplot2.html#cb78-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_colour_brewer</span>(<span class="at">palette =</span> <span class="st">&quot;Set1&quot;</span>) <span class="co"># scale_colour is a widely used one</span></span></code></pre></div>
<p><img src="Exploratory_data_analysis_for_cancer_biologists_files/figure-html/geom_point6-2.png" width="672" /></p>
<p>You can play with the positioning of the legend, too -</p>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="plotting-using-ggplot2.html#cb79-1" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> </span>
<span id="cb79-2"><a href="plotting-using-ggplot2.html#cb79-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">colour=</span>class), <span class="at">size =</span> <span class="dv">3</span>, <span class="at">alpha =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb79-3"><a href="plotting-using-ggplot2.html#cb79-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;left&quot;</span>)</span></code></pre></div>
<p><img src="Exploratory_data_analysis_for_cancer_biologists_files/figure-html/geom_point7-1.png" width="672" /></p>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="plotting-using-ggplot2.html#cb80-1" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> </span>
<span id="cb80-2"><a href="plotting-using-ggplot2.html#cb80-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">colour=</span>class), <span class="at">size =</span> <span class="dv">3</span>, <span class="at">alpha =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb80-3"><a href="plotting-using-ggplot2.html#cb80-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>) </span></code></pre></div>
<p><img src="Exploratory_data_analysis_for_cancer_biologists_files/figure-html/geom_point7-2.png" width="672" />
#### Coordinate system</p>
<p>I will discuss it with box polt later in this chapter.</p>
</div>
</div>
<div id="faceting" class="section level4 hasAnchor" number="2.3.2.3">
<h4><span class="header-section-number">2.3.2.3</span> Faceting<a href="plotting-using-ggplot2.html#faceting" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>If you have too many data points, the idea of faceting is to sub-setting the plot by an appropriate variable -</p>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb81-1"><a href="plotting-using-ggplot2.html#cb81-1" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> </span>
<span id="cb81-2"><a href="plotting-using-ggplot2.html#cb81-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">colour=</span>class), <span class="at">size =</span> <span class="dv">3</span>, <span class="at">alpha =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb81-3"><a href="plotting-using-ggplot2.html#cb81-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> class, <span class="at">ncol =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="Exploratory_data_analysis_for_cancer_biologists_files/figure-html/faceting-1.png" width="672" /></p>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="plotting-using-ggplot2.html#cb82-1" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> </span>
<span id="cb82-2"><a href="plotting-using-ggplot2.html#cb82-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">colour=</span>class), <span class="at">size =</span> <span class="dv">3</span>, <span class="at">alpha =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb82-3"><a href="plotting-using-ggplot2.html#cb82-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(<span class="sc">~</span> class) <span class="co"># if there were any blank plot, won&#39;t be plotted here</span></span></code></pre></div>
<p><img src="Exploratory_data_analysis_for_cancer_biologists_files/figure-html/faceting-2.png" width="672" /></p>
</div>
<div id="theme" class="section level4 hasAnchor" number="2.3.2.4">
<h4><span class="header-section-number">2.3.2.4</span> Theme<a href="plotting-using-ggplot2.html#theme" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>There are different themes to play with -</p>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb83-1"><a href="plotting-using-ggplot2.html#cb83-1" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> </span>
<span id="cb83-2"><a href="plotting-using-ggplot2.html#cb83-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">colour=</span>class), <span class="at">size =</span> <span class="dv">3</span>, <span class="at">alpha =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb83-3"><a href="plotting-using-ggplot2.html#cb83-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>()</span></code></pre></div>
<p><img src="Exploratory_data_analysis_for_cancer_biologists_files/figure-html/theme-1.png" width="672" /></p>
</div>
<div id="other-geometric-objects" class="section level4 hasAnchor" number="2.3.2.5">
<h4><span class="header-section-number">2.3.2.5</span> Other geometric objects<a href="plotting-using-ggplot2.html#other-geometric-objects" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div id="bar-plot-and-position-adjustment" class="section level5 hasAnchor" number="2.3.2.5.1">
<h5><span class="header-section-number">2.3.2.5.1</span> Bar plot and position adjustment<a href="plotting-using-ggplot2.html#bar-plot-and-position-adjustment" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>By default, the bar plot comes as stacked. If you fill it by a variable that is not used to plot the bars, you can see what I mean. However, for playing with the bar plot, I will be using another dataset called ‘diamonds’ that comes with <strong>R</strong>.</p>
<p>To begin with -</p>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="plotting-using-ggplot2.html#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>diamonds) <span class="sc">+</span></span>
<span id="cb84-2"><a href="plotting-using-ggplot2.html#cb84-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x=</span>cut))</span></code></pre></div>
<p><img src="Exploratory_data_analysis_for_cancer_biologists_files/figure-html/bar_plot1-1.png" width="672" /></p>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="plotting-using-ggplot2.html#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>diamonds) <span class="sc">+</span></span>
<span id="cb85-2"><a href="plotting-using-ggplot2.html#cb85-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x=</span>cut, <span class="at">fill=</span>cut))</span></code></pre></div>
<p><img src="Exploratory_data_analysis_for_cancer_biologists_files/figure-html/bar_plot2-1.png" width="672" /></p>
<p>But -</p>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="plotting-using-ggplot2.html#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>diamonds) <span class="sc">+</span></span>
<span id="cb86-2"><a href="plotting-using-ggplot2.html#cb86-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x=</span>cut, <span class="at">fill=</span>clarity))</span></code></pre></div>
<p><img src="Exploratory_data_analysis_for_cancer_biologists_files/figure-html/bar_plot3-1.png" width="672" /></p>
<p>The position is adjusted by the position argument which takes in three options - “identity”, “fill”, and “dodge”</p>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb87-1"><a href="plotting-using-ggplot2.html#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>diamonds) <span class="sc">+</span></span>
<span id="cb87-2"><a href="plotting-using-ggplot2.html#cb87-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x=</span>cut, <span class="at">fill=</span>clarity), <span class="at">position =</span> <span class="st">&quot;identity&quot;</span>)</span></code></pre></div>
<p><img src="Exploratory_data_analysis_for_cancer_biologists_files/figure-html/bar_plot4-1.png" width="672" /></p>
<p>Here, each object falls exactly where it should be in the context of the plot and seems to be overlapped. It can be a little better if you use fill = NA or use alpha value</p>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb88-1"><a href="plotting-using-ggplot2.html#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>diamonds) <span class="sc">+</span></span>
<span id="cb88-2"><a href="plotting-using-ggplot2.html#cb88-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x=</span>cut, <span class="at">fill=</span>clarity), <span class="at">position =</span> <span class="st">&quot;identity&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.2</span>)</span></code></pre></div>
<p><img src="Exploratory_data_analysis_for_cancer_biologists_files/figure-html/bar_plot5-1.png" width="672" /></p>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="plotting-using-ggplot2.html#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>diamonds) <span class="sc">+</span></span>
<span id="cb89-2"><a href="plotting-using-ggplot2.html#cb89-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x=</span>cut, <span class="at">colour=</span>clarity), <span class="at">position =</span> <span class="st">&quot;identity&quot;</span>, <span class="at">fill=</span><span class="cn">NA</span>) <span class="co"># mind the change of colour and fill</span></span></code></pre></div>
<p><img src="Exploratory_data_analysis_for_cancer_biologists_files/figure-html/bar_plot5-2.png" width="672" /></p>
<p>Position fill catches up all the space vertically for each bar and displays as fraction of the values</p>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb90-1"><a href="plotting-using-ggplot2.html#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>diamonds) <span class="sc">+</span></span>
<span id="cb90-2"><a href="plotting-using-ggplot2.html#cb90-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x=</span>cut, <span class="at">fill=</span>clarity), <span class="at">position =</span> <span class="st">&quot;fill&quot;</span>)</span></code></pre></div>
<p><img src="Exploratory_data_analysis_for_cancer_biologists_files/figure-html/bar_plot6-1.png" width="672" /></p>
<p>But what we usually mean by the bar plots is the next -</p>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb91-1"><a href="plotting-using-ggplot2.html#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>diamonds) <span class="sc">+</span></span>
<span id="cb91-2"><a href="plotting-using-ggplot2.html#cb91-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x=</span>cut, <span class="at">fill=</span>clarity), <span class="at">position =</span> <span class="st">&quot;dodge&quot;</span>)</span></code></pre></div>
<p><img src="Exploratory_data_analysis_for_cancer_biologists_files/figure-html/bar_plot7-1.png" width="672" /></p>
</div>
<div id="boxplot" class="section level5 hasAnchor" number="2.3.2.5.2">
<h5><span class="header-section-number">2.3.2.5.2</span> Boxplot<a href="plotting-using-ggplot2.html#boxplot" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>Box plot is very convenient to see the distribution of your data and compare side by side the distributions of different variables in your data -</p>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb92-1"><a href="plotting-using-ggplot2.html#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(class, hwy)) <span class="sc">+</span></span>
<span id="cb92-2"><a href="plotting-using-ggplot2.html#cb92-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb92-3"><a href="plotting-using-ggplot2.html#cb92-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>()</span></code></pre></div>
<p><img src="Exploratory_data_analysis_for_cancer_biologists_files/figure-html/boxplot-1.png" width="672" /></p>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb93-1"><a href="plotting-using-ggplot2.html#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(class, hwy)) <span class="sc">+</span></span>
<span id="cb93-2"><a href="plotting-using-ggplot2.html#cb93-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb93-3"><a href="plotting-using-ggplot2.html#cb93-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_polar</span>()</span></code></pre></div>
<p><img src="Exploratory_data_analysis_for_cancer_biologists_files/figure-html/boxplot-2.png" width="672" /></p>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb94-1"><a href="plotting-using-ggplot2.html#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Please don&#39;t plot boxplot in this way in real-life.</span></span></code></pre></div>
</div>
</div>
</div>
<div id="the-rest-of-the-exercise-is-a-copy-of-the-top-50-ggplot2-visualizations---the-master-list-with-full-r-code." class="section level3 hasAnchor" number="2.3.3">
<h3><span class="header-section-number">2.3.3</span> The rest of the exercise is a copy of the “Top 50 ggplot2 Visualizations - The Master List (With Full R Code)”.<a href="plotting-using-ggplot2.html#the-rest-of-the-exercise-is-a-copy-of-the-top-50-ggplot2-visualizations---the-master-list-with-full-r-code." class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The link: <a href="http://r-statistics.co/Top50-Ggplot2-Visualizations-MasterList-R-Code.html" class="uri">http://r-statistics.co/Top50-Ggplot2-Visualizations-MasterList-R-Code.html</a></p>
<p>Correlation</p>
<p>The following plots help to examine how well correlated two variables are.</p>
<p>Scatterplot</p>
<p>The most frequently used plot for data analysis is undoubtedly the scatterplot. Whenever you want to understand the nature of relationship between two variables, invariably the first choice is the scatterplot.</p>
<p>It can be drawn using <code>geom_point()</code>. Additionally, geom_smooth which draws a smoothing line (based on loess) by default, can be tweaked to draw the line of best fit by setting method=‘lm’.</p>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb95-1"><a href="plotting-using-ggplot2.html#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages(&quot;ggplot2&quot;)</span></span>
<span id="cb95-2"><a href="plotting-using-ggplot2.html#cb95-2" aria-hidden="true" tabindex="-1"></a><span class="co"># load package and data</span></span>
<span id="cb95-3"><a href="plotting-using-ggplot2.html#cb95-3" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">scipen=</span><span class="dv">999</span>)  <span class="co"># turn-off scientific notation like 1e+48</span></span>
<span id="cb95-4"><a href="plotting-using-ggplot2.html#cb95-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb95-5"><a href="plotting-using-ggplot2.html#cb95-5" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_set</span>(<span class="fu">theme_bw</span>())  <span class="co"># pre-set the bw theme.</span></span>
<span id="cb95-6"><a href="plotting-using-ggplot2.html#cb95-6" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;midwest&quot;</span>, <span class="at">package =</span> <span class="st">&quot;ggplot2&quot;</span>)</span>
<span id="cb95-7"><a href="plotting-using-ggplot2.html#cb95-7" aria-hidden="true" tabindex="-1"></a><span class="co"># midwest &lt;- read.csv(&quot;http://goo.gl/G1K41K&quot;)  # bkup data source</span></span>
<span id="cb95-8"><a href="plotting-using-ggplot2.html#cb95-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-9"><a href="plotting-using-ggplot2.html#cb95-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Scatterplot</span></span>
<span id="cb95-10"><a href="plotting-using-ggplot2.html#cb95-10" aria-hidden="true" tabindex="-1"></a>gg <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(midwest, <span class="fu">aes</span>(<span class="at">x=</span>area, <span class="at">y=</span>poptotal)) <span class="sc">+</span> </span>
<span id="cb95-11"><a href="plotting-using-ggplot2.html#cb95-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">col=</span>state, <span class="at">size=</span>popdensity)) <span class="sc">+</span> </span>
<span id="cb95-12"><a href="plotting-using-ggplot2.html#cb95-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method=</span><span class="st">&quot;loess&quot;</span>, <span class="at">se=</span>F) <span class="sc">+</span> </span>
<span id="cb95-13"><a href="plotting-using-ggplot2.html#cb95-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.1</span>)) <span class="sc">+</span> </span>
<span id="cb95-14"><a href="plotting-using-ggplot2.html#cb95-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">500000</span>)) <span class="sc">+</span> </span>
<span id="cb95-15"><a href="plotting-using-ggplot2.html#cb95-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">subtitle=</span><span class="st">&quot;Area Vs Population&quot;</span>, </span>
<span id="cb95-16"><a href="plotting-using-ggplot2.html#cb95-16" aria-hidden="true" tabindex="-1"></a>       <span class="at">y=</span><span class="st">&quot;Population&quot;</span>, </span>
<span id="cb95-17"><a href="plotting-using-ggplot2.html#cb95-17" aria-hidden="true" tabindex="-1"></a>       <span class="at">x=</span><span class="st">&quot;Area&quot;</span>, </span>
<span id="cb95-18"><a href="plotting-using-ggplot2.html#cb95-18" aria-hidden="true" tabindex="-1"></a>       <span class="at">title=</span><span class="st">&quot;Scatterplot&quot;</span>, </span>
<span id="cb95-19"><a href="plotting-using-ggplot2.html#cb95-19" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption =</span> <span class="st">&quot;Source: midwest&quot;</span>)</span>
<span id="cb95-20"><a href="plotting-using-ggplot2.html#cb95-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-21"><a href="plotting-using-ggplot2.html#cb95-21" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(gg)</span></code></pre></div>
<pre><code>## `geom_smooth()` using formula = &#39;y ~ x&#39;</code></pre>
<pre><code>## Warning: Removed 15 rows containing non-finite values (`stat_smooth()`).</code></pre>
<pre><code>## Warning: Removed 15 rows containing missing values (`geom_point()`).</code></pre>
<p><img src="Exploratory_data_analysis_for_cancer_biologists_files/figure-html/practice-1.png" width="672" /></p>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="data-manipulation-using-dplyr.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="metabric-data-analysis.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="assets/gitbook-2.6.7/js/app.min.js"></script>
<script src="assets/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="assets/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="assets/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="assets/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="assets/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="assets/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="assets/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/AMMHasan/Exploratory_data_analysis_for_cancer_biologists/edit/master/04-plotting.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": "https://github.com/AMMHasan/Exploratory_data_analysis_for_cancer_biologists/blob/master/04-plotting.Rmd",
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
},
"toolbar": {
"position": "static"
}
});
});
</script>

</body>

</html>
